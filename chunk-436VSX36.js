import{a as R}from"./chunk-PWEP6JZV.js";import{a as N}from"./chunk-RZE7YYSQ.js";import"./chunk-K5QABCWY.js";import"./chunk-FBWHH6JU.js";import{b as I}from"./chunk-227JUHIO.js";import{a as y,b as B,c as G,d as ve}from"./chunk-UEPNQQPW.js";import"./chunk-JRFFUKYU.js";import"./chunk-MFPXOXAK.js";import{a as ge,b as fe,c as ke,d as be,e as _e}from"./chunk-3OLZPOF4.js";import{b as ee,c as H,d as te,e as oe,f as z,h as v,j as ie,k as ne,l as re,m as le,n as se,o as ae,p as me,q as ce,r as de,u as pe,v as ue}from"./chunk-RQYECNT5.js";import{b as V,c as he}from"./chunk-IMD2KKFX.js";import{A as M,F,G as q,Ha as w,Ia as K,Ja as Q,K as g,L as f,V as p,W as S,Za as W,_a as X,aa as J,ca as u,cb as Y,da as O,ja as o,ka as n,la as m,lb as Z,ma as C,mb as E,na as c,oa as P,qb as j,ta as b,ua as _,va as h,wa as L,xa as a,ya as A}from"./chunk-TK5UYZ3D.js";var Fe=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=F({type:t,selectors:[["app-bookings"]],decls:1,vars:0,template:function(r,i){r&1&&m(0,"router-outlet")},dependencies:[Z]});let s=t;return s})();var Te=()=>({name:"All Bookings",link:"#/home/guests/bookings/all-bookings"}),Ee=s=>[s];function Ve(s,t){if(s&1){let k=C();o(0,"tr",17),c("click",function(){let r=g(k).$implicit,i=P();return f(i.viewBookingDetails(r.id))}),o(1,"td"),a(2),n(),o(3,"td"),a(4),n(),o(5,"td"),a(6),n(),o(7,"td"),a(8),n()()}if(s&2){let k=t.$implicit;p(2),A(k.booking_id),p(2),A(k.guest==null?null:k.guest.guest_name),p(2),A(k.room==null?null:k.room.price_per_night),p(2),A(k.room==null?null:k.room.room_number)}}function Ie(s,t){if(s&1&&(o(0,"tr")(1,"td",18),m(2,"app-table-loader",19),n()()),s&2){let k=P();p(2),u("isLoading",k.isFetchingListData)("isNoData",k.isDataAvailable)}}var $=(()=>{let t=class t{constructor(e,r){this.router=e,this.bookingsService=r,this.isFetchingListData=!1,this.isDataAvailable=!0,this.filterQuery="",this.pagination={currentPage:0,totalPages:0,totalItems:0},this.sorting={currentField:"created_at",currentDirection:"-"},this.bookingListData=[]}ngAfterViewInit(){this.getAllHotelBooking()}getAllHotelBooking(){this.isFetchingListData=!0,this.bookingsService.getAllHotelBookings().subscribe({next:e=>{console.log(e),this.bookingListData=e.results,this.pagination.currentPage=e.current_page,this.pagination.totalPages=e.total_pages,this.pagination.totalItems=e.count,this.pagination.totalItems==0&&(this.isDataAvailable=!1)},error:e=>{console.log(e)},complete:()=>{this.isFetchingListData=!1}})}pageSelected(){this.getAllHotelBooking()}columnSorted(e){console.log(e),this.sorting.currentField=e.field,this.sorting.currentDirection=e.direction,this.getAllHotelBooking()}tableFiltered(e){this.filterQuery=e,this.getAllHotelBooking()}viewBookingDetails(e){localStorage.setItem("hotel_booking_id",e),this.router.navigate(["/home/guests/bookings/edit-view-booking/",e])}goToCreateBooking(){this.router.navigate(["/home/guests/bookings/create-booking"])}};t.\u0275fac=function(r){return new(r||t)(S(E),S(R))},t.\u0275cmp=F({type:t,selectors:[["app-all-bookings"]],decls:27,vars:27,consts:[[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-9"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"d-inline-block","w-100","mb-3"],[1,"btn","btn-primary","btn-sm","mb-3","grid-add-btn",3,"click"],[3,"tableFiltered","placeholder"],[1,"table-responsive"],[1,"table","table-sm","table-hover","table-bordered"],["width","20%"],[3,"columnSorted","columnTitle","thisField","currentField","currentDirection"],["width","40%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"pageSelected","totalItems","currentPage"],[3,"click"],["colspan","4"],[3,"isLoading","isNoData"]],template:function(r,i){r&1&&(m(0,"app-topnav",0),o(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),a(6,"Bookings"),n(),o(7,"div",6)(8,"button",7),c("click",function(){return i.goToCreateBooking()}),a(9," Add New Booking "),n(),o(10,"app-table-filtering",8),c("tableFiltered",function(d){return i.tableFiltered(d)}),n()(),o(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th",11)(16,"app-table-sorting",12),c("columnSorted",function(d){return i.columnSorted(d)}),n()(),o(17,"th",13)(18,"app-table-sorting",12),c("columnSorted",function(d){return i.columnSorted(d)}),n()(),o(19,"th",11)(20,"app-table-sorting",12),c("columnSorted",function(d){return i.columnSorted(d)}),n()(),o(21,"th",11)(22,"app-table-sorting",12),c("columnSorted",function(d){return i.columnSorted(d)}),n()()()(),o(23,"tbody"),J(24,Ve,9,4,"tr",14)(25,Ie,3,2,"tr",15),n()()(),o(26,"app-table-pagination",16),c("pageSelected",function(){return i.pageSelected()}),n()()()()()),r&2&&(u("pageTitle","Bookings")("navItems",K(25,Ee,w(24,Te))),p(10),u("placeholder","Search Bookings"),p(6),u("columnTitle","Booking ID")("thisField","booking_id")("currentField",i.sorting.currentField)("currentDirection",i.sorting.currentDirection),p(2),u("columnTitle","Guest Name")("thisField","guest")("currentField",i.sorting.currentField)("currentDirection",i.sorting.currentDirection),p(2),u("columnTitle","Rate")("thisField","room")("currentField",i.sorting.currentField)("currentDirection",i.sorting.currentDirection),p(2),u("columnTitle","Room No#")("thisField","room")("currentField",i.sorting.currentField)("currentDirection",i.sorting.currentDirection),p(2),u("ngForOf",i.bookingListData),p(),u("ngIf",i.isFetchingListData||!i.isDataAvailable),p(),u("totalItems",i.pagination.totalItems)("currentPage",i.pagination.currentPage)("totalItems",i.pagination.totalItems))},dependencies:[W,X,V,fe,ke,be,ge]});let s=t;return s})();var Re=["selectGuestComponentReference"],Ne=["selectRoomComponentReference"],D=(()=>{let t=class t{constructor(){this.bookingForm=new z({}),this.selectedGuestId="",this.selectedRoomId="",this.isSubmitted=!1}ngOnInit(){this.initBookingForm()}initBookingForm(){this.bookingForm=new z({booking_id:new v(""),guest:new v({value:"",disabled:!0},H.required),room:new v({value:"",disabled:!0},H.required),rate:new v({value:0,disabled:!0}),booking_status:new v("Confirmed"),phone:new v(""),planned_check_in_date:new v(new Date().toISOString().split("T")[0]),planned_check_out_date:new v(""),expected_num_of_guests:new v(""),special_requests:new v("")})}guestRowSelected(e){this.selectedGuestId=e?.id,this.bookingForm.controls.guest.setValue(e?.guest_name),this.bookingForm.controls.phone.setValue(e?.phone_number),console.log(e)}roomRowSelected(e){this.selectedRoomId=e?.id,this.bookingForm.controls.room.setValue(e?.room_number),this.bookingForm.controls.rate.setValue(e?.price_per_night),console.log(e)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=F({type:t,selectors:[["app-booking-form"]],viewQuery:function(r,i){if(r&1&&(b(Re,5,I),b(Ne,5,N)),r&2){let l;_(l=h())&&(i.selectGuest=l.first),_(l=h())&&(i.selectRoom=l.first)}},decls:84,vars:5,consts:[["selectGuestComponentReference",""],["selectRoomComponentReference",""],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"row","mb-1"],[1,"col-md-4"],["for","booking_id",1,"float-md-end","float-sm-start","col-form-label"],[1,"col-md-8"],["id","booking_id","name","booking_id","formControlName","booking_id","required","",1,"form-control"],["for","guest",1,"float-md-end","float-sm-start","col-form-label"],[1,"text-danger"],[1,"input-group","w-100"],["id","guest","name","guest","formControlName","guest",1,"form-control"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"bi","bi-window"],["for","phone",1,"float-md-end","float-sm-start","col-form-label"],["type","text","id","phone","name","phone","formControlName","phone",1,"form-control"],["for","room",1,"float-md-end","float-sm-start","col-form-label"],["type","text","id","room","name","room","formControlName","room",1,"form-control"],["for","rate",1,"float-md-end","float-sm-start","col-form-label"],["id","rate","name","rate","formControlName","rate","required","",1,"form-control"],["for","booking_status",1,"float-md-end","float-sm-start","col-form-label"],["id","booking_status","name","booking_status","formControlName","booking_status","required","",1,"form-select"],["value","1"],["value","2"],["value","3"],["for","planned_check_in_date",1,"float-md-end","float-sm-start","col-form-label"],["type","date","id","planned_check_in_date","name","planned_check_in_date","formControlName","planned_check_in_date","required","",1,"form-control"],["for","planned_check_out_date",1,"float-md-end","float-sm-start","col-form-label"],["type","date","id","planned_check_out_date","name","planned_check_out_date","formControlName","planned_check_out_date","required","",1,"form-control"],["for","expected_num_of_guests",1,"float-md-end","float-sm-start","col-form-label"],["type","number","id","expected_num_of_guests","name","expected_num_of_guests","formControlName","expected_num_of_guests","min","1",1,"form-control"],["for","special_requests",1,"float-md-end","float-sm-start","col-form-label"],["id","special_requests","name","special_requests","formControlName","special_requests","rows","3",1,"form-control"],[3,"rowSelected"]],template:function(r,i){if(r&1){let l=C();o(0,"form",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"label",7),a(6,"Booking ID:"),n()(),o(7,"div",8),m(8,"input",9),n()(),o(9,"div",5)(10,"div",6)(11,"label",10)(12,"span",11),a(13,"* "),n(),a(14,"Guest Name:"),n()(),o(15,"div",8)(16,"div",12),m(17,"input",13),o(18,"button",14),c("click",function(){g(l);let T=L(81);return f(T.openModal())}),m(19,"i",15),n()()()(),o(20,"div",5)(21,"div",6)(22,"label",16),a(23,"Phone:"),n()(),o(24,"div",8),m(25,"input",17),n()(),o(26,"div",5)(27,"div",6)(28,"label",18)(29,"span",11),a(30,"* "),n(),a(31,"Room No.:"),n()(),o(32,"div",8)(33,"div",12),m(34,"input",19),o(35,"button",14),c("click",function(){g(l);let T=L(83);return f(T.openModal())}),m(36,"i",15),n()()()(),o(37,"div",5)(38,"div",6)(39,"label",20),a(40,"Rate:"),n()(),o(41,"div",8),m(42,"input",21),n()(),o(43,"div",5)(44,"div",6)(45,"label",22),a(46,"Booking Status:"),n()(),o(47,"div",8)(48,"select",23)(49,"option",24),a(50,"Confirmed"),n(),o(51,"option",25),a(52,"Pending"),n(),o(53,"option",26),a(54,"Cancelled"),n()()()()(),o(55,"div",4)(56,"div",5)(57,"div",6)(58,"label",27),a(59,"Check-in Date:"),n()(),o(60,"div",8),m(61,"input",28),n()(),o(62,"div",5)(63,"div",6)(64,"label",29),a(65,"Check-out Date:"),n()(),o(66,"div",8),m(67,"input",30),n()(),o(68,"div",5)(69,"div",6)(70,"label",31),a(71,"Expected Number of Guests:"),n()(),o(72,"div",8),m(73,"input",32),n()(),o(74,"div",5)(75,"div",6)(76,"label",33),a(77,"Special Requests:"),n()(),o(78,"div",8),m(79,"textarea",34),n()()()()(),o(80,"app-select-guest",35,0),c("rowSelected",function(T){return g(l),f(i.guestRowSelected(T))}),n(),o(82,"app-select-room",35,1),c("rowSelected",function(T){return g(l),f(i.roomRowSelected(T))}),n()}r&2&&(u("formGroup",i.bookingForm),p(17),O("is-invalid",i.bookingForm.controls.guest.invalid&&i.isSubmitted),p(17),O("is-invalid",i.bookingForm.controls.room.invalid&&i.isSubmitted))},dependencies:[ie,ae,me,ee,ne,se,te,oe,de,ce,re,le,I,N]});let s=t;return s})();var Me=["successToastComponentReference"],qe=["errorToastComponentReference"],Qe=()=>({name:"All Bookings",link:"#/home/guests/bookings"}),Ge=()=>({name:"New Bookings",link:"#/home/guests/bookings/create-booking"}),Oe=(s,t)=>[s,t],ye=(()=>{let t=class t{constructor(e,r){this.bookingsService=e,this.router=r}onSave(){this.bookingForm.isSubmitted=!0,this.bookingForm.bookingForm.valid&&this.createBooking()}handleCancelForm(){this.router.navigate(["/home/guests/bookings"])}getBookingData(){return{hotel:localStorage.getItem("hotel_id"),booking_id:this.bookingForm.bookingForm.controls.booking_id.value,guest:this.bookingForm.selectedGuestId,room:this.bookingForm.selectedRoomId,rate:this.bookingForm.bookingForm.controls.rate.value,phone:this.bookingForm.bookingForm.controls.phone.value,planned_check_in_date:this.bookingForm.bookingForm.controls.planned_check_in_date.value,planned_check_out_date:this.bookingForm.bookingForm.controls.planned_check_out_date.value,expected_num_of_guests:this.bookingForm.bookingForm.controls.expected_num_of_guests.value,special_requests:this.bookingForm.bookingForm.controls.special_requests.value,booking_status:this.bookingForm.bookingForm.controls.booking_status.value}}createBooking(){let e=this.getBookingData();this.bookingsService.createBooking(e).subscribe(r=>{this.successToast.openToast(),this.router.navigate(["/home/guests/bookings"])},r=>{this.errorToast.openToast()})}};t.\u0275fac=function(r){return new(r||t)(S(R),S(E))},t.\u0275cmp=F({type:t,selectors:[["app-create-booking"]],viewQuery:function(r,i){if(r&1&&(b(D,5),b(Me,5,y),b(qe,5,B)),r&2){let l;_(l=h())&&(i.bookingForm=l.first),_(l=h())&&(i.successToast=l.first),_(l=h())&&(i.errorToast=l.first)}},decls:17,vars:7,consts:[["errorToastComponentReference",""],["successToastComponentReference",""],[3,"pageTitle","navItems"],[1,"row"],[1,"col"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"mt-3"],["type","submit",1,"btn","btn-sm","btn-success","float-end","ms-2","form-control-btn",3,"click"],["type","reset",1,"btn","btn-sm","btn-warning","float-end","ms-2","form-control-btn",3,"click"]],template:function(r,i){if(r&1){let l=C();m(0,"app-topnav",2),o(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h5",7),a(6,"Add New Booking"),n(),m(7,"app-booking-form"),o(8,"div",8)(9,"button",9),c("click",function(){return g(l),f(i.onSave())}),a(10," Save "),n(),o(11,"button",10),c("click",function(){return g(l),f(i.handleCancelForm())}),a(12," Cancel "),n()()()()()(),m(13,"app-error-toast",null,0)(15,"app-success-toast",null,1)}r&2&&u("pageTitle","Bookings")("navItems",Q(4,Oe,w(2,Qe),w(3,Ge)))},dependencies:[V,y,B,D]});let s=t;return s})();var Pe=["bookingFormComponentReference"],Le=["successToastComponentReference"],je=["errorToastComponentReference"],He=["deleteModalOneComponentReference"],ze=()=>({name:"Bookings",link:"#/home/guests/bookings/all-bookings"}),Ue=()=>({name:"View-Edit Booking",link:"#/home/guests/bookings/all-bookings/edit-view-booking"}),$e=(s,t)=>[s,t],Be=(()=>{let t=class t{constructor(e,r){this.router=e,this.bookingService=r,this.isFetchingData=!1,this.isSavingData=!1,this.isDeletingData=!1,this.bookingId=localStorage.getItem("hotel_booking_id")}ngAfterViewInit(){setTimeout(()=>{this.getBooking()},0)}onSave(){this.bookingForm.isSubmitted=!0,this.bookingForm.bookingForm.valid&&this.updateBooking()}onDelete(){this.deleteModalOne.openModal()}getBooking(){if(!this.bookingForm||!this.bookingForm.bookingForm){console.error("Booking form is not initialized");return}this.isFetchingData=!0,this.bookingService.getBookingById().subscribe({next:e=>{console.log(e),this.setBookingData(e),this.isFetchingData=!1},error:e=>{console.log(e),this.isFetchingData=!1}})}updateBooking(){this.isSavingData=!0;let e=this.getBookingData();this.bookingService.updateBookingById(e).subscribe({next:r=>{console.log(r),this.isSavingData=!1},error:r=>{this.isSavingData=!1,console.log(r)}})}deleteBooking(){this.isDeletingData=!0,this.bookingService.deleteBookingById().subscribe({next:e=>{console.log(e),this.isDeletingData=!1,this.router.navigateByUrl("/home/guests/bookings")},error:e=>{console.log(e),this.isDeletingData=!1}})}setBookingData(e){if(!this.bookingForm||!this.bookingForm.bookingForm){console.error("Booking form is not initialized");return}this.bookingForm.bookingForm.controls.booking_id.setValue(e.booking_id||""),this.bookingForm.bookingForm.controls.guest.setValue(e.guest?.guest_name||""),this.bookingForm.bookingForm.controls.phone.setValue(e.guest?.phone_number||""),this.bookingForm.bookingForm.controls.room.setValue(e.room?.room_number||""),this.bookingForm.bookingForm.controls.rate.setValue(e.room?.price_per_night||""),this.bookingForm.bookingForm.controls.planned_check_in_date.setValue(e.planned_check_in_date||""),this.bookingForm.bookingForm.controls.planned_check_out_date.setValue(e.planned_check_out_date||""),this.bookingForm.bookingForm.controls.expected_num_of_guests.setValue(e.expected_num_of_guests||""),this.bookingForm.bookingForm.controls.special_requests.setValue(e.special_requests||""),this.bookingForm.bookingForm.controls.booking_status.setValue(e.booking_status||""),this.bookingForm.selectedGuestId=e.guest?.id||"",this.bookingForm.selectedRoomId=e.room?.id||"",console.log("Booking data set successfully",this.bookingForm.bookingForm.value)}getBookingData(){return{hotel:localStorage.getItem("hotel_id"),booking_id:this.bookingForm.bookingForm.controls.booking_id.value,guest:this.bookingForm.selectedGuestId,room:this.bookingForm.selectedRoomId,rate:this.bookingForm.bookingForm.controls.rate.value,phone:this.bookingForm.bookingForm.controls.phone.value,planned_check_in_date:this.bookingForm.bookingForm.controls.planned_check_in_date.value,planned_check_out_date:this.bookingForm.bookingForm.controls.planned_check_out_date.value,expected_num_of_guests:this.bookingForm.bookingForm.controls.expected_num_of_guests.value,special_requests:this.bookingForm.bookingForm.controls.special_requests.value,booking_status:this.bookingForm.bookingForm.controls.booking_status.value}}cancel(){this.router.navigate(["/home/guests/bookings"])}};t.\u0275fac=function(r){return new(r||t)(S(E),S(R))},t.\u0275cmp=F({type:t,selectors:[["app-view-edit-booking"]],viewQuery:function(r,i){if(r&1&&(b(Pe,5,D),b(Le,5,y),b(je,5,B),b(He,5,G)),r&2){let l;_(l=h())&&(i.bookingForm=l.first),_(l=h())&&(i.successToast=l.first),_(l=h())&&(i.errorToast=l.first),_(l=h())&&(i.deleteModalOne=l.first)}},decls:21,vars:7,consts:[["errorToastComponentReference",""],["successToastComponentReference",""],["deleteModalOneReference",""],[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"col","mt-3"],["type","button",1,"btn","btn-sm","btn-success","float-end","ms-2","form-control-btn",3,"click"],["type","button",1,"btn","btn-sm","btn-warning","float-end","ms-2","form-control-btn",3,"click"],["type","button",1,"btn","btn-sm","btn-danger","float-end","ms-2","form-control-btn",3,"click"],[3,"confirmEvent"]],template:function(r,i){if(r&1){let l=C();m(0,"app-topnav",3),o(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h5",8),a(6,"View-Edit Booking"),n(),m(7,"app-booking-form"),o(8,"div",9)(9,"button",10),c("click",function(){return g(l),f(i.onSave())}),a(10," Save "),n(),o(11,"button",11),c("click",function(){return g(l),f(i.cancel())}),a(12," Cancel "),n(),o(13,"button",12),c("click",function(){return g(l),f(i.onDelete())}),a(14," Delete "),n()()()()()(),m(15,"app-error-toast",null,0)(17,"app-success-toast",null,1),o(19,"app-delete-modal-one",13,2),c("confirmEvent",function(){return g(l),f(i.deleteBooking())}),n()}r&2&&u("pageTitle","Bookings")("navItems",Q(4,$e,w(2,ze),w(3,Ue)))},dependencies:[V,G,y,B,D]});let s=t;return s})();var Je=[{path:"",component:Fe,children:[{path:"",component:$},{path:"all-bookings",component:$},{path:"create-booking",component:ye},{path:"edit-view-booking/:id",component:Be}]}],De=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=q({type:t}),t.\u0275inj=M({imports:[j.forChild(Je),j]});let s=t;return s})();var Lt=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=q({type:t}),t.\u0275inj=M({imports:[Y,pe,ue,De,he,_e,I,N,ve]});let s=t;return s})();export{Lt as BookingsModule};
