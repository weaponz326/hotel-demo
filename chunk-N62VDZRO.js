import{a as P}from"./chunk-TMGJ6XNB.js";import{a as Be}from"./chunk-DQC53J6Z.js";import{a as Q}from"./chunk-BKJTHQG2.js";import{a as T,b as w,c as N,d as Fe}from"./chunk-UEPNQQPW.js";import{a as E}from"./chunk-JRFFUKYU.js";import{a as _e}from"./chunk-6TRWRYDX.js";import{a as Se}from"./chunk-SCGM7UR2.js";import{a as ye,b as Ce,c as M,d as ke,e as Ie}from"./chunk-3OLZPOF4.js";import{b as me,d as ce,e as z,f as de,g as pe,j as J,k as ue,l as he,m as fe,t as ve,u as be,v as ge}from"./chunk-RQYECNT5.js";import{b as B,c as De}from"./chunk-IMD2KKFX.js";import{A as j,F as h,G,Ha as I,Ia as L,Ja as W,K as y,Ka as ne,L as C,La as R,Ma as V,V as a,W as v,Za as le,_a as oe,a as q,aa as te,b as O,bb as x,ca as c,cb as re,ga as H,ha as $,ia as U,ja as l,ka as o,kb as ae,la as m,lb as se,ma as D,mb as F,na as f,oa as X,qb as Y,ta as g,ua as _,va as S,xa as s,ya as u,za as ie}from"./chunk-TK5UYZ3D.js";var Te=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=h({type:i,selectors:[["app-bills"]],decls:1,vars:0,template:function(n,t){n&1&&m(0,"router-outlet")},dependencies:[se]});let r=i;return r})();var je=["newBillComponentReference"],Ge=()=>({name:"All Bills",link:"#/home/finance/bills"}),He=r=>[r];function $e(r,i){if(r&1){let p=D();l(0,"tr",20),f("click",function(){let n=y(p).$implicit,t=X();return C(t.viewBillDetails(n.id))}),l(1,"td"),s(2),o(),l(3,"td"),s(4),o(),l(5,"td"),s(6),R(7,"date"),o(),l(8,"td"),s(9),o()()}if(r&2){let p=i.$implicit;a(2),u(p.bill_id),a(2),u(p.check_in_check_out==null||p.check_in_check_out.guest==null?null:p.check_in_check_out.guest.guest_name),a(2),u(V(7,4,p.created_at)),a(3),u(p.total_amount)}}function Ue(r,i){if(r&1&&(l(0,"tr")(1,"td",21),m(2,"app-table-loader",22),o()()),r&2){let p=X();a(2),c("isLoading",p.isFetchingListData)("isNoData",p.isDataAvailable)}}var ee=(()=>{let i=class i{constructor(e,n){this.router=e,this.billService=n,this.bills=[],this.billHeaders=["Bill Type","Guest","Description","Amount"],this.isLoading=!0,this.isFetchingListData=!0,this.isDataAvailable=!1,this.filterQuery="",this.pagination={currentPage:0,totalPages:0,totalItems:0},this.sorting={currentField:"created_at",currentDirection:"-"}}pageSelected(){this.getBills()}columnSorted(e){console.log(e),this.sorting.currentField=e.field,this.sorting.currentDirection=e.direction,this.getBills()}tableFiltered(e){this.filterQuery=e,this.getBills()}ngAfterViewInit(){this.getBills()}getBills(){this.billService.getAllHotelBills().subscribe({next:e=>{console.log(e.results),this.bills=e.results,this.pagination.currentPage=e.current_page,this.pagination.totalPages=e.total_pages,this.pagination.totalItems=e.count,this.pagination.totalItems==0?this.isDataAvailable=!1:this.isDataAvailable=!0,this.isFetchingListData=!1},error:e=>{console.error("Error occurred:",e),this.isFetchingListData=!1},complete:()=>{console.log("Request completed"),this.isFetchingListData=!1}})}viewBillDetails(e){localStorage.setItem("hotel_bill_id",e),this.router.navigate(["/home/finance/bills/edit-view-bill/",e])}goToCreateBill(){this.router.navigate(["/home/finance/bills/create-bill"])}};i.\u0275fac=function(n){return new(n||i)(v(F),v(Q))},i.\u0275cmp=h({type:i,selectors:[["app-all-bills"]],viewQuery:function(n,t){if(n&1&&g(je,5),n&2){let d;_(d=S())&&(t.createBill=d.first)}},decls:31,vars:25,consts:[[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-9"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"d-inline-block","w-100","mb-3"],["type","button",1,"btn","btn-primary","btn-sm","mb-3","grid-add-btn",3,"click"],[3,"placeholder"],[1,"table-responsive"],[1,"table","table-sm","table-hover","table-bordered"],["width","30%"],[3,"columnSorted","columnTitle","thisField","currentField","currentDirection"],["width","20%"],["width","15%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"totalItems"],[1,"col-md-3"],["link","/home/finance/payments","name","Go to Payments"],[3,"click"],["colspan","4"],[3,"isLoading","isNoData"]],template:function(n,t){n&1&&(m(0,"app-topnav",0),l(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),s(6,"Bills"),o(),l(7,"div",6)(8,"button",7),f("click",function(){return t.goToCreateBill()}),s(9," Add New Bill "),o(),m(10,"app-table-filtering",8),o(),l(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th",11)(16,"app-table-sorting",12),f("columnSorted",function(b){return t.columnSorted(b)}),o()(),l(17,"th",11)(18,"app-table-sorting",12),f("columnSorted",function(b){return t.columnSorted(b)}),o()(),l(19,"th",13)(20,"app-table-sorting",12),f("columnSorted",function(b){return t.columnSorted(b)}),o()(),l(21,"th",14)(22,"app-table-sorting",12),f("columnSorted",function(b){return t.columnSorted(b)}),o()()()(),l(23,"tbody"),te(24,$e,10,6,"tr",15)(25,Ue,3,2,"tr",16),o()(),m(26,"app-table-pagination",17),o()()()(),l(27,"div",18)(28,"div",3)(29,"div",4),m(30,"app-page-link-button",19),o()()()()),n&2&&(c("pageTitle","Bills")("navItems",L(23,He,I(22,Ge))),a(10),c("placeholder","Search Bills"),a(6),c("columnTitle","Bill ID")("thisField","bill_id")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),a(2),c("columnTitle","Guest Name")("thisField","check_in_check_out?.guest_name")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),a(2),c("columnTitle","Bill Date")("thisField","createdAt")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),a(2),c("columnTitle","Total Amount")("thisField","total_amount")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),a(2),c("ngForOf",t.bills),a(),c("ngIf",t.isFetchingListData||!t.isDataAvailable),a(),c("totalItems",t.bills.length))},dependencies:[le,oe,B,Ce,M,ke,ye,E,x]});let r=i;return r})();var ze=["selectCheckinComponentReference"],A=(()=>{let i=class i{constructor(e){this.formBuilder=e,this.billForm=new de({}),this.isDisabled=!1,this.isSubmitted=!1,this.selectedCheckInId=""}ngOnInit(){this.initializeFormData()}initializeFormData(){this.billForm=this.formBuilder.group({id:[{value:"",disabled:!0}],created_at:[{value:"",disabled:!0}],updated_at:[{value:"",disabled:!0}],deleted_at:[{value:"",disabled:!0}],hotel:[{value:"",disabled:!0}],guest_name:[{value:"",disabled:!0}],bill_id:[{value:"",disabled:!0}],check_in_check_out:[{value:"",disabled:!0}],room_subtotal:[{value:0,disabled:!0}],services_subtotal:[{value:0,disabled:!0}],amenities_subtotal:[{value:0,disabled:!0}],total_amount:[{value:0,disabled:!0}],note:[""],additional_charges:[]})}checkinRowSelected(e){this.selectedCheckInId=e?.id,this.billForm.controls.check_in_check_out.setValue(e?.checkin_id),this.billForm.controls.guest_name.setValue(e?.guest?.guest_name),localStorage.setItem("hotel_check_in_check_out_id",e?.id)}};i.\u0275fac=function(n){return new(n||i)(v(ve))},i.\u0275cmp=h({type:i,selectors:[["app-bill-form"]],viewQuery:function(n,t){if(n&1&&g(ze,5,P),n&2){let d;_(d=S())&&(t.selectCheckin=d.first)}},decls:37,vars:1,consts:[["selectCheckinComponentReference",""],[1,"module-form-control","form-group","row",3,"formGroup"],[1,"col-md-12"],[1,"row","mb-1"],[1,"col-md-4"],["for","bill_id",1,"float-md-end","float-sm-start","col-form-label"],[1,"col-md-8"],["type","text","name","bill_id","id","bill_id","formControlName","bill_id",1,"form-control"],["for","check_in_check_out",1,"float-md-end","float-sm-start","col-form-label"],[1,"input-group","w-100"],["type","text","name","check_in_check_out","id","check_in_check_out","formControlName","check_in_check_out",1,"form-control"],["type","button","title","Select Check-In",1,"btn","btn-secondary",3,"click"],[1,"bi","bi-window"],["for","guest_name",1,"float-md-end","float-sm-start","col-form-label"],["type","text","name","guest_name","id","guest_name","formControlName","guest_name",1,"form-control"],["for","note",1,"float-md-end","float-sm-start","col-form-label"],["name","note","id","note","rows","3","formControlName","note",1,"form-control"],["for","total_amount",1,"float-md-end","float-sm-start","col-form-label"],["type","number","name","total_amount","id","total_amount","formControlName","total_amount",1,"form-control"],[3,"rowSelected"]],template:function(n,t){if(n&1){let d=D();l(0,"form",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),s(5,"Bill ID"),o()(),l(6,"div",6),m(7,"input",7),o()(),l(8,"div",3)(9,"div",4)(10,"label",8),s(11,"Check-in/Check-out"),o()(),l(12,"div",6)(13,"div",9),m(14,"input",10),l(15,"button",11),f("click",function(){return y(d),C(t.selectCheckin.openModal())}),m(16,"i",12),o()()()(),l(17,"div",3)(18,"div",4)(19,"label",13),s(20,"Guest Name"),o()(),l(21,"div",6),m(22,"input",14),o()(),l(23,"div",3)(24,"div",4)(25,"label",15),s(26,"Note"),o()(),l(27,"div",6),m(28,"textarea",16),o()(),l(29,"div",3)(30,"div",4)(31,"label",17),s(32,"Total Amount"),o()(),l(33,"div",6),m(34,"input",18),o()()()(),l(35,"app-select-checkin",19,0),f("rowSelected",function(Oe){return y(d),C(t.checkinRowSelected(Oe))}),o()}n&2&&c("formGroup",t.billForm)},dependencies:[J,me,ue,ce,z,he,fe,P],styles:[".modal-footer[_ngcontent-%COMP%]{gap:.25rem}"]});let r=i;return r})();var Xe=["billForm"],Ye=["successToastComponentReference"],Ze=["errorToastComponentReference"],et=["deleteModalOneComponentReference"],tt=()=>({name:"All Bills",link:"#/home/finance/bills"}),it=r=>({name:"View Bill",link:r}),nt=(r,i)=>[r,i],Ve=(()=>{let i=class i{constructor(e,n,t){this.route=e,this.router=n,this.billService=t,this.billId="",this.expectedBillCheckInCheckOutId="",this.isLoading=!1}onSave(){this.billForm.isSubmitted=!0,this.billForm.billForm.valid&&this.handleUpdateBill()}onDelete(){this.deleteModal.openModal()}ngOnInit(){this.billId=this.route.snapshot.params.billId}ngAfterViewInit(){this.getBill()}getBill(){this.billService.getHotelBillById(this.billId).subscribe({next:e=>{console.log("Successfully retrieved restaurant bill",e),this.setBillFormData(e),this.expectedBill=e,this.expectedBillCheckInCheckOutId=e.check_in_check_out?.id,this.isLoading=!1},error:e=>{console.error(`Error retrieving restaurant bill: ${e.message}`),this.isLoading=!1},complete:()=>{this.isLoading=!1,console.log("Fetching complete")}})}setBillFormData(e){this.billForm.billForm.patchValue(e),this.billForm.billForm.controls.check_in_check_out.setValue(e?.check_in_check_out?.checkin_id),this.billForm.billForm.controls.guest_name.setValue(e?.check_in_check_out?.guest?.guest_name)}handleUpdateBill(){this.isLoading=!0;let e=O(q({},this.billForm.billForm.value),{check_in_check_out:this.expectedBillCheckInCheckOutId,hotel:localStorage.getItem("hotel_id")});this.billService.updateHotelBillById(this.billId,e).subscribe({next:n=>{"Bill update successful";this.router.navigateByUrl("/home/finance/bills"),this.isLoading=!1,this.successToast.openToast()},error:n=>{console.log(n.message),n.message,this.isLoading=!1,this.errorToast.openToast()}})}handleDeleteBill(){this.isLoading=!0,this.billService.deleteHotelBillById(this.billId).subscribe({next:e=>{console.log(e),this.router.navigateByUrl("/home/finance/bills"),this.isLoading=!1,this.successToast.openToast()},error:e=>{console.log(e),this.isLoading=!1,this.errorToast.openToast()}})}handleCancelEvent(){this.router.navigate(["/home/food/bills"])}};i.\u0275fac=function(n){return new(n||i)(v(ae),v(F),v(Q))},i.\u0275cmp=h({type:i,selectors:[["app-edit-view-bill"]],viewQuery:function(n,t){if(n&1&&(g(Xe,5,A),g(Ye,5,T),g(Ze,5,w),g(et,5,N)),n&2){let d;_(d=S())&&(t.billForm=d.first),_(d=S())&&(t.successToast=d.first),_(d=S())&&(t.errorToast=d.first),_(d=S())&&(t.deleteModal=d.first)}},decls:31,vars:17,consts:[["billForm",""],["errorToastComponentReference",""],["successToastComponentReference",""],["deleteModalOneComponentReference",""],[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-6","row"],[1,"card"],[1,"card-body"],[1,"card-title"],["type","submit",1,"btn","btn-sm","btn-success","float-end","ms-2","form-control-btn",3,"click","disabled"],["type","reset",1,"btn","btn-sm","btn-warning","float-end","ms-2","form-control-btn",3,"click","disabled"],["type","reset",1,"btn","btn-sm","btn-danger","float-end","ms-2","form-control-btn",3,"click","disabled"],[1,"col-md-3"],[1,"card","mb-1"],[3,"link","name"],[3,"confirmEvent"]],template:function(n,t){if(n&1){let d=D();m(0,"app-topnav",4),l(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"h5",9),s(6,"View Bill"),o(),m(7,"app-bill-form",null,0),l(9,"button",10),f("click",function(){return y(d),C(t.onSave())}),s(10," Save "),o(),l(11,"button",11),f("click",function(){return y(d),C(t.handleCancelEvent())}),s(12," Cancel "),o(),l(13,"button",12),f("click",function(){return y(d),C(t.onDelete())}),s(14," Delete "),o()()()(),l(15,"div",13)(16,"div",14)(17,"div",8),m(18,"app-page-link-button",15),o()(),l(19,"div",14)(20,"div",8),m(21,"app-page-link-button",15),o()(),l(22,"div",14)(23,"div",8),m(24,"app-page-link-button",15),o()()()(),m(25,"app-error-toast",null,1)(27,"app-success-toast",null,2),l(29,"app-delete-modal-one",16,3),f("confirmEvent",function(){return y(d),C(t.handleDeleteBill())}),o()}n&2&&(c("pageTitle","Bills")("navItems",W(14,nt,I(11,tt),L(12,it,"#/home/finance/bills/"+t.billId))),a(9),c("disabled",t.isLoading),a(2),c("disabled",t.isLoading),a(2),c("disabled",t.isLoading),a(5),c("link","all-bill-items")("name","Bill Items"),a(3),c("link","/home/finance/payments/create-payment")("name","Create Payment"),a(3),c("link","/home/finance/payments")("name","Go to Payments"))},dependencies:[B,E,N,T,w,A]});let r=i;return r})();var lt=["successToastComponentReference"],ot=["errorToastComponentReference"],rt=["deleteModalOneComponentReference"],at=()=>({name:"All Bills",link:"#/home/finance/bills"}),st=()=>({name:"Create Bill",link:"#/home/finance/bills/create-bill"}),mt=(r,i)=>[r,i],xe=(()=>{let i=class i{constructor(e,n){this.billsService=e,this.router=n,this.isLoading=!1}onSave(){this.billForm.isSubmitted=!0,this.billForm.billForm.valid&&this.handleCreateBill()}handleCreateBill(){let e=this.getBillFormData(),n=O(q({},e),{check_in_check_out:this.billForm.selectedCheckInId});this.createBill(n)}handleCancelForm(){this.router.navigate(["/home/finance/bills"])}getBillFormData(){return this.billForm.billForm.value}createBill(e){this.isLoading=!0;let n=localStorage.getItem("hotel_id"),t=O(q({},e),{hotel:n});console.log(t),this.billsService.createHotelBill(t).subscribe({next:()=>{"Bill has been created successfully";this.isLoading=!1,this.successToast.openToast()},error:d=>{`${d.message}`,this.isLoading=!1,this.errorToast.openToast()},complete:()=>{console.log("Complete bill posting action"),this.router.navigate(["/home/finance/bills"])}})}};i.\u0275fac=function(n){return new(n||i)(v(Q),v(F))},i.\u0275cmp=h({type:i,selectors:[["app-create-bill"]],viewQuery:function(n,t){if(n&1&&(g(A,5),g(lt,5,T),g(ot,5,w),g(rt,5,N)),n&2){let d;_(d=S())&&(t.billForm=d.first),_(d=S())&&(t.successToast=d.first),_(d=S())&&(t.errorToast=d.first),_(d=S())&&(t.deleteModal=d.first)}},decls:21,vars:11,consts:[["billForm",""],["errorToastComponentReference",""],["successToastComponentReference",""],[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-body"],[1,"card-title"],["type","submit",1,"btn","btn-sm","btn-success","float-end","ms-2","form-control-btn",3,"click","disabled"],["type","reset",1,"btn","btn-sm","btn-warning","float-end","ms-2","form-control-btn",3,"click","disabled"],[1,"col-md-3"],[3,"link","name"]],template:function(n,t){if(n&1){let d=D();m(0,"app-topnav",3),l(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h5",8),s(6,"New Bill"),o(),m(7,"app-bill-form",null,0),l(9,"button",9),f("click",function(){return y(d),C(t.onSave())}),s(10," Save "),o(),l(11,"button",10),f("click",function(){return y(d),C(t.handleCancelForm())}),s(12," Cancel "),o()()()(),l(13,"div",11)(14,"div",6)(15,"div",7),m(16,"app-page-link-button",12),o()()()(),m(17,"app-error-toast",null,1)(19,"app-success-toast",null,2)}n&2&&(c("pageTitle","Bills")("navItems",W(8,mt,I(6,at),I(7,st))),a(9),c("disabled",t.isLoading),a(2),c("disabled",t.isLoading),a(5),c("link","/home/finance/payments")("name","Go to Payments"))},dependencies:[B,E,T,w,A]});let r=i;return r})();var Me=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=h({type:i,selectors:[["app-checkin-items"]],inputs:{checkinData:"checkinData"},decls:40,vars:5,consts:[[1,"card"],[1,"card-body"],[1,"card-title"],[1,"row","mb-1"],[1,"col-md-4"],["for","guest",1,"float-md-end","float-sm-start","col-form-label"],[1,"col-md-8"],["type","text","id","guest","name","guest","disabled","",1,"form-control",3,"value"],["for","checkin_id",1,"float-md-end","float-sm-start","col-form-label"],["type","text","id","checkin_id","name","checkin_id","disabled","",1,"form-control",3,"value"],["for","room_type",1,"float-md-end","float-sm-start","col-form-label"],["type","text","id","room_type","name","room_type","disabled","",1,"form-control",3,"value"],["for","room_rate",1,"float-md-end","float-sm-start","col-form-label"],["type","number","min","0","id","room_rate","name","room_rate","disabled","",1,"form-control",3,"value"],["for","number of nights",1,"float-md-end","float-sm-start","col-form-label"],["type","number","min","0","id","number_of_nights","name","number_of_nights","disabled","",1,"form-control",3,"value"],[1,"mt-3"],[1,"float-end"]],template:function(n,t){n&1&&(l(0,"div",0)(1,"div",1)(2,"h5",2),s(3,"Check-In / Room Bill items"),o(),l(4,"form")(5,"div",3)(6,"div",4)(7,"label",5),s(8,"Guest Name:"),o()(),l(9,"div",6),m(10,"input",7),o()(),l(11,"div",3)(12,"div",4)(13,"label",8),s(14,"Check-In ID:"),o()(),l(15,"div",6),m(16,"input",9),o()(),l(17,"div",3)(18,"div",4)(19,"label",10),s(20,"Room Type:"),o()(),l(21,"div",6),m(22,"input",11),o()(),l(23,"div",3)(24,"div",4)(25,"label",12),s(26,"Room Rate:"),o()(),l(27,"div",6),m(28,"input",13),o()(),l(29,"div",3)(30,"div",4)(31,"label",14),s(32,"Number of Nights:"),o()(),l(33,"div",6),m(34,"input",15),o()()(),l(35,"div",16)(36,"p",17),s(37," Check-In / Room sub total: "),l(38,"strong"),s(39),o()()()()()),n&2&&(a(10),c("value",t.checkinData==null||t.checkinData.guest==null?null:t.checkinData.guest.guest_name),a(6),c("value",t.checkinData==null?null:t.checkinData.checkin_id),a(6),c("value",t.checkinData==null||t.checkinData.room==null?null:t.checkinData.room.type),a(6),c("value",t.checkinData==null||t.checkinData.room==null?null:t.checkinData.room.price_per_night),a(11),u(t.checkinData==null||t.checkinData.room==null?null:t.checkinData.room.price_per_night))},dependencies:[J,z,pe]});let r=i;return r})();function dt(r,i){if(r&1&&(l(0,"tr")(1,"td"),s(2),o(),l(3,"td"),s(4),o(),l(5,"td"),s(6),o(),l(7,"td"),s(8),R(9,"date"),o()()),r&2){let p=i.$implicit;a(2),u(p==null?null:p.service_request_id),a(2),u(p==null||p.service==null?null:p.service.service_name),a(2),u(p==null||p.service==null?null:p.service.price),a(2),u(V(9,4,p==null?null:p.request_date_time))}}var Ne=(()=>{let i=class i{constructor(){this.servicesSubtotal=0}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=h({type:i,selectors:[["app-servces-items"]],inputs:{serviceListData:"serviceListData",servicesSubtotal:"servicesSubtotal"},decls:24,vars:5,consts:[[1,"card"],[1,"card-body"],[1,"card-title"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],[3,"columnTitle"],[1,"float-end"]],template:function(n,t){n&1&&(l(0,"div",0)(1,"div",1)(2,"h5",2),s(3,"Serivces Bill items"),o(),l(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),m(9,"app-table-sorting",5),o(),l(10,"th"),m(11,"app-table-sorting",5),o(),l(12,"th"),m(13,"app-table-sorting",5),o(),l(14,"th"),m(15,"app-table-sorting",5),o()()(),l(16,"tbody"),$(17,dt,10,6,"tr",null,H),o()()(),l(19,"div")(20,"p",6),s(21," Services sub total: "),l(22,"strong"),s(23),o()()()()()),n&2&&(a(9),c("columnTitle","Service ID"),a(2),c("columnTitle","Services Name"),a(2),c("columnTitle","Price"),a(2),c("columnTitle","Date Requested"),a(2),U(t.serviceListData),a(6),u(t.servicesSubtotal))},dependencies:[M,x]});let r=i;return r})();function ut(r,i){if(r&1&&(l(0,"tr")(1,"td"),s(2),o(),l(3,"td"),s(4),o(),l(5,"td"),s(6),o(),l(7,"td"),s(8),R(9,"date"),o()()),r&2){let p=i.$implicit;a(2),u(p==null?null:p.amenity_request_id),a(2),u(p==null||p.amenity==null?null:p.amenity.amenity_name),a(2),u(p==null||p.amenity==null?null:p.amenity.price),a(2),u(V(9,4,p==null?null:p.request_date_time))}}var Qe=(()=>{let i=class i{constructor(){this.amenitiesSubtotal=0}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=h({type:i,selectors:[["app-amenities-items"]],inputs:{amenityListData:"amenityListData",amenitiesSubtotal:"amenitiesSubtotal"},decls:24,vars:5,consts:[[1,"card"],[1,"card-body"],[1,"card-title"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],[3,"columnTitle"],[1,"float-end"]],template:function(n,t){n&1&&(l(0,"div",0)(1,"div",1)(2,"h5",2),s(3,"Amenities Bill items"),o(),l(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),m(9,"app-table-sorting",5),o(),l(10,"th"),m(11,"app-table-sorting",5),o(),l(12,"th"),m(13,"app-table-sorting",5),o(),l(14,"th"),m(15,"app-table-sorting",5),o()()(),l(16,"tbody"),$(17,ut,10,6,"tr",null,H),o()()(),l(19,"div")(20,"p",6),s(21," Amenities sub total: "),l(22,"strong"),s(23),o()()()()()),n&2&&(a(9),c("columnTitle","Amenity Request ID"),a(2),c("columnTitle","Amenity Name"),a(2),c("columnTitle","Price"),a(2),c("columnTitle","Request Date"),a(2),U(t.amenityListData),a(6),u(t.amenitiesSubtotal))},dependencies:[M,x]});let r=i;return r})();var ft=()=>({name:"All Bills",link:"#/home/finance/bills"}),vt=r=>({name:"View Bill",link:r}),bt=r=>({name:"Bill Items",link:r}),gt=(r,i,p)=>[r,i,p],Pe=(()=>{let i=class i{constructor(e,n,t,d){this.router=e,this.checkinService=n,this.amenityService=t,this.serviceService=d,this.checkinId=localStorage.getItem("hotel_check_in_check_out_id"),this.checkinData={},this.amenityListData=[],this.serviceListData=[],this.isFetchingListData=!0,this.isDataAvailable=!0,this.grandTotal=0,this.amenitiesSubtotal=0,this.servicesSubtotal=0,this.roomSubtotal=0,this.filterQuery="",this.pagination={currentPage:0,totalPages:0,totalItems:0},this.sorting={currentField:"created_at",currentDirection:"-"}}ngAfterViewInit(){this.getCheckin(),this.getAllAmenitiesWithCheckinId(),this.getAllServiceRequestsWithCheckinId()}getCheckin(){this.checkinService.getCheckInOutById(this.checkinId).subscribe({next:e=>{console.log("Successfully retrieved restaurant checkin",e),this.checkinData=e,this.calculateCheckInSubtotal(e)},error:e=>{console.error(`Error retrieving restaurant checkin: ${e.message}`)},complete:()=>{console.log("Fetching complete")}})}getAllAmenitiesWithCheckinId(){this.isFetchingListData=!0,this.amenityService.getAllHotelAmenitiesRequest().subscribe({next:e=>{console.log("Results: ",e.results);let n=e.results.filter(t=>t.check_in?.id===localStorage.getItem("hotel_check_in_check_out_id"));console.log("Filtered Amenities Results: ",n),console.log(localStorage.getItem("hotel_check_in_check_out_id")),this.amenityListData=n,this.calculateAmenitiesRequestSubtotal(n),this.pagination.currentPage=e.current_page,this.pagination.totalPages=e.total_pages,this.pagination.totalItems=e.count,this.pagination.totalItems==0&&(this.isDataAvailable=!1)},error:e=>{console.log(e)},complete:()=>{this.isFetchingListData=!1}})}getAllServiceRequestsWithCheckinId(){this.isFetchingListData=!0,this.serviceService.getAllHotelServiceRequest().subscribe({next:e=>{console.log("Results: ",e.results);let n=e.results.filter(t=>t.check_in?.id===localStorage.getItem("hotel_check_in_check_out_id"));console.log("Filtered Service Results: ",n),console.log(localStorage.getItem("hotel_check_in_check_out_id")),this.serviceListData=n,this.calculateServicesRequestSubtotal(n),this.pagination.currentPage=e.current_page,this.pagination.totalPages=e.total_pages,this.pagination.totalItems=e.count,this.pagination.totalItems==0&&(this.isDataAvailable=!1)},error:e=>{console.log(e)},complete:()=>{this.isFetchingListData=!1}})}calculateCheckInSubtotal(e){this.roomSubtotal=Number(e.room?.price_per_night),console.log("Room Subtotal",this.roomSubtotal),this.grandTotal+=this.roomSubtotal}calculateAmenitiesRequestSubtotal(e){this.amenitiesSubtotal=e.reduce((n,t)=>n+Number(t.price||0),0),console.log("Amenities Subtotal",this.amenitiesSubtotal),this.grandTotal+=this.amenitiesSubtotal}calculateServicesRequestSubtotal(e){this.servicesSubtotal=e.reduce((n,t)=>n+Number(t?.service?.price||0),0),console.log("Services Subtotal",this.amenitiesSubtotal),this.grandTotal+=this.servicesSubtotal}};i.\u0275fac=function(n){return new(n||i)(v(F),v(Be),v(Se),v(_e))},i.\u0275cmp=h({type:i,selectors:[["app-all-bill-items"]],decls:17,vars:17,consts:[[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-6"],[3,"checkinData"],[1,"col-md-3"],[1,"card","text-center"],[1,"card-body"],[1,"card-title"],[1,"display-6"],[1,"col-md-8"],[3,"serviceListData","servicesSubtotal"],[3,"amenityListData","amenitiesSubtotal"]],template:function(n,t){n&1&&(m(0,"app-topnav",0),l(1,"div",1)(2,"div",2),m(3,"app-checkin-items",3),o(),l(4,"div",4)(5,"div",5)(6,"div",6)(7,"h5",7),s(8,"Grand Total"),o(),l(9,"h1",8),s(10),o()()()()(),l(11,"div",1)(12,"div",9),m(13,"app-servces-items",10),o()(),l(14,"div",1)(15,"div",9),m(16,"app-amenities-items",11),o()()),n&2&&(c("pageTitle","Bills")("navItems",ne(13,gt,I(8,ft),L(9,vt,"#/home/finance/bills/edit-view-bill/"+t.checkinId),L(11,bt,"#/home/finance/bills/edit-view-bill/"+t.checkinId+"/bill-items"))),a(3),c("checkinData",t.checkinData),a(7),ie("$ ",t.grandTotal,""),a(3),c("serviceListData",t.serviceListData)("servicesSubtotal",t.servicesSubtotal),a(3),c("amenityListData",t.amenityListData)("amenitiesSubtotal",t.amenitiesSubtotal))},dependencies:[B,Me,Ne,Qe]});let r=i;return r})();var _t=[{path:"",component:Te,children:[{path:"",component:ee},{path:"all-bills",component:ee},{path:"create-bill",component:xe},{path:"edit-view-bill/:billId",component:Ve},{path:"edit-view-bill/:billId/all-bill-items",component:Pe}]}],qe=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=G({type:i}),i.\u0275inj=j({imports:[Y.forChild(_t),Y]});let r=i;return r})();var Ii=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=G({type:i}),i.\u0275inj=j({imports:[re,be,ge,qe,De,Ie,E,P,Fe]});let r=i;return r})();export{Ii as BillsModule};
