import{a as Oe}from"./chunk-BKJTHQG2.js";import{a as P,b as T,c as M,d as xe}from"./chunk-UEPNQQPW.js";import{a as D}from"./chunk-JRFFUKYU.js";import{a as Z,b as ee,c as te,d as ie,e as ne}from"./chunk-3OLZPOF4.js";import{a as se,b as ce,c as pe}from"./chunk-LN2M4CNM.js";import{b as we,c as me,d as Pe,e as Te,f as De,j as Ee,k as Ie,l as Be,m as ke,n as Ve,o as Le,p as Me,t as Ae,u as Re,v as Qe}from"./chunk-RQYECNT5.js";import{b as L,c as Ne}from"./chunk-IMD2KKFX.js";import{A as x,C as he,F as C,G as O,Ga as be,Ha as B,Ia as G,Ja as U,K as f,L as h,La as z,Ma as J,Q as oe,R as ge,V as m,W as v,Za as K,_a as W,a as Q,aa as j,b as N,ba as re,bb as X,ca as c,cb as Y,da as ae,fb as ve,ga as $,ha as q,ia as H,ja as o,ka as n,kb as Se,la as d,lb as Ce,ma as F,mb as V,na as u,oa as k,qb as le,rb as Fe,ta as g,ua as _,va as b,xa as s,ya as S,z as fe,za as _e}from"./chunk-TK5UYZ3D.js";var je=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=C({type:i,selectors:[["app-payments"]],decls:1,vars:0,template:function(r,t){r&1&&d(0,"router-outlet")},dependencies:[Ce]});let a=i;return a})();var A=(()=>{let i=class i{constructor(e){this.http=e,this.apiBaseUrl=Fe.apiBaseUrl}getAllHotelPayments(){return this.http.get(`${this.apiBaseUrl}/hotel/finance/payments/payments?hotel=${localStorage.getItem("hotel_id")}`)}getHotelPaymentById(e){return this.http.get(`${this.apiBaseUrl}/hotel/finance/payments/payments/${localStorage.getItem("hotel_payment_id")}`)}updateHotelPaymentById(e,r){return this.http.put(`${this.apiBaseUrl}/hotel/finance/payments/payments/${localStorage.getItem("hotel_payment_id")}`,r)}deleteHotelPaymentById(e){return this.http.delete(`${this.apiBaseUrl}/hotel/finance/payments/payments/${localStorage.getItem("hotel_payment_id")}
       )}`)}createHotelPayment(e){return this.http.post(`${this.apiBaseUrl}/hotel/finance/payments/payments/`,e)}};i.\u0275fac=function(r){return new(r||i)(he(ve))},i.\u0275prov=fe({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var Ze=["newPaymentComponentReference"],et=()=>({name:"All Payments",link:"#/home/finance/payments"}),tt=a=>[a];function it(a,i){if(a&1){let p=F();o(0,"tr",20),u("click",function(){let r=f(p).$implicit,t=k();return h(t.viewPaymentDetails(r.id))}),o(1,"td"),s(2),n(),o(3,"td"),s(4),n(),o(5,"td"),s(6),n(),o(7,"td"),s(8),z(9,"date"),n(),o(10,"td"),s(11),n()()}if(a&2){let p=i.$implicit;m(2),S(p.payment_id),m(2),_e(" ",p.bill==null||p.bill.check_in_check_out==null||p.bill.check_in_check_out.guest==null?null:p.bill.check_in_check_out.guest.guest_name," "),m(2),S(p.payment_method),m(2),S(J(9,5,p.payment_date)),m(3),S(p.amount)}}function nt(a,i){if(a&1&&(o(0,"tr")(1,"td",21),d(2,"app-table-loader",22),n()()),a&2){let p=k();m(2),c("isLoading",p.isFetchingListData)("isNoData",p.isDataAvailable)}}var ye=(()=>{let i=class i{pageSelected(){this.getPayments()}columnSorted(e){console.log(e),this.sorting.currentField=e.field,this.sorting.currentDirection=e.direction,this.getPayments()}tableFiltered(e){this.filterQuery=e,this.getPayments()}constructor(e,r){this.router=e,this.paymentService=r,this.payments=[],this.paymentHeaders=["Payment Type","Guest","Description","Amount"],this.isFetchingListData=!0,this.isDataAvailable=!1,this.filterQuery="",this.pagination={currentPage:0,totalPages:0,totalItems:0},this.sorting={currentField:"created_at",currentDirection:"-"}}ngAfterViewInit(){this.getPayments()}getPayments(){this.paymentService.getAllHotelPayments().subscribe({next:e=>{console.log(e.results),this.payments=e.results,this.pagination.currentPage=e.current_page,this.pagination.totalPages=e.total_pages,this.pagination.totalItems=e.count,this.pagination.totalItems==0?this.isDataAvailable=!1:this.isDataAvailable=!0},error:e=>{console.error("Error occurred:",e),this.isFetchingListData=!1},complete:()=>{console.log("Request completed"),this.isFetchingListData=!1}})}viewPaymentDetails(e){localStorage.setItem("hotel_payment_id",e),this.router.navigate(["/home/finance/payments/edit-view-payment/",e])}goToCreatePayment(){this.router.navigate(["/home/finance/payments/create-payment"])}};i.\u0275fac=function(r){return new(r||i)(v(V),v(A))},i.\u0275cmp=C({type:i,selectors:[["app-all-payments"]],viewQuery:function(r,t){if(r&1&&g(Ze,5),r&2){let l;_(l=b())&&(t.createPayment=l.first)}},decls:33,vars:29,consts:[[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-9"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"d-inline-block","w-100","mb-3"],["type","button",1,"btn","btn-primary","btn-sm","mb-3","grid-add-btn",3,"click"],[3,"placeholder"],[1,"table-responsive"],[1,"table","table-sm","table-hover","table-bordered"],["width","20%"],[3,"columnSorted","columnTitle","thisField","currentField","currentDirection"],["width","25%"],["width","15%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"totalItems"],[1,"col-md-3"],["link","/home/finance/bills","name","Go to Bills"],[3,"click"],["colspan","5"],[3,"isLoading","isNoData"]],template:function(r,t){r&1&&(d(0,"app-topnav",0),o(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),s(6,"Payments"),n(),o(7,"div",6)(8,"button",7),u("click",function(){return t.goToCreatePayment()}),s(9," Add New Payment "),n(),d(10,"app-table-filtering",8),n(),o(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th",11)(16,"app-table-sorting",12),u("columnSorted",function(y){return t.columnSorted(y)}),n()(),o(17,"th",13)(18,"app-table-sorting",12),u("columnSorted",function(y){return t.columnSorted(y)}),n()(),o(19,"th",13)(20,"app-table-sorting",12),u("columnSorted",function(y){return t.columnSorted(y)}),n()(),o(21,"th",14)(22,"app-table-sorting",12),u("columnSorted",function(y){return t.columnSorted(y)}),n()(),o(23,"th",14)(24,"app-table-sorting",12),u("columnSorted",function(y){return t.columnSorted(y)}),n()()()(),o(25,"tbody"),j(26,it,12,7,"tr",15)(27,nt,3,2,"tr",16),n()()(),d(28,"app-table-pagination",17),n()()(),o(29,"div",18)(30,"div",3)(31,"div",4),d(32,"app-page-link-button",19),n()()()()),r&2&&(c("pageTitle","Payments")("navItems",G(27,tt,B(26,et))),m(10),c("placeholder","Search Payments"),m(6),c("columnTitle","Payment ID")("thisField","payment_id")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Guest Name")("thisField","guest")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Payment Method")("thisField","payment_method")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Date")("thisField","date")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Amount")("thisField","amount")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("ngForOf",t.payments),m(),c("ngIf",t.isFetchingListData||!t.isDataAvailable),m(),c("totalItems",t.payments.length))},dependencies:[K,W,L,D,ee,te,ie,Z,X]});let a=i;return a})();var ot=["openButtonElementReference"],rt=["closeButtonElementReference"];function at(a,i){if(a&1){let p=F();o(0,"tr",23),u("click",function(){let r=f(p).$implicit,t=k();return h(t.selectRow(r))}),o(1,"td"),s(2),n(),o(3,"td"),s(4),n(),o(5,"td"),s(6),z(7,"date"),n(),o(8,"td"),s(9),n()()}if(a&2){let p=i.$implicit;m(2),S(p.bill_id),m(2),S(p.check_in_check_out==null||p.check_in_check_out.guest==null?null:p.check_in_check_out.guest.guest_name),m(2),S(J(7,4,p.created_at)),m(3),S(p.total_amount)}}function lt(a,i){if(a&1&&(o(0,"tr")(1,"td",24),d(2,"app-table-loader",25),n()()),a&2){let p=k();m(2),c("isLoading",p.isFetchingListData)("isNoData",p.isDataAvailable)}}var R=(()=>{let i=class i{constructor(e){this.billService=e,this.rowSelected=new ge,this.closeTarget="",this.billsListData=[],this.isFetchingListData=!1,this.isDataAvailable=!0,this.filterQuery="",this.pagination={currentPage:0,totalPages:0,totalItems:0},this.sorting={currentField:"created_at",currentDirection:"-"}}openModal(){this.billsListData=[],this.getAllBill(),this.openButton.nativeElement.click()}getAllBill(){this.isFetchingListData=!0,this.billService.getAllHotelBills().subscribe({next:e=>{console.log(e),this.billsListData=e.results,this.pagination.currentPage=e.current_page,this.pagination.totalPages=e.total_pages,this.pagination.totalItems=e.count,this.isFetchingListData=!1,this.pagination.totalItems==0&&(this.isDataAvailable=!1)},error:e=>{console.log(e)}})}pageSelected(){this.getAllBill()}columnSorted(e){console.log(e),this.sorting.currentField=e.field,this.sorting.currentDirection=e.direction,this.getAllBill()}tableFiltered(e){this.filterQuery=e,this.getAllBill()}selectRow(e){this.rowSelected.emit(e),this.closeButton.nativeElement.click(),console.log(e)}};i.\u0275fac=function(r){return new(r||i)(v(Oe))},i.\u0275cmp=C({type:i,selectors:[["app-select-bill"]],viewQuery:function(r,t){if(r&1&&(g(ot,5,oe),g(rt,5,oe)),r&2){let l;_(l=b())&&(t.openButton=l.first),_(l=b())&&(t.closeButton=l.first)}},inputs:{closeTarget:"closeTarget"},outputs:{rowSelected:"rowSelected"},standalone:!0,features:[be],decls:32,vars:24,consts:[["openButtonElementReference",""],["closeButtonElementReference",""],["data-bs-toggle","modal","data-bs-target","#selectBillModal",3,"hidden"],["id","selectBillModal","tabindex","-1","aria-labelledby","selectBillModalLabel","aria-hidden","true",1,"modal","fade","select-table-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header","bg-light"],["id","selectBillModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close","data-bs-toggle","modal",1,"btn-close"],[1,"modal-body"],[1,"d-inline-block","w-100","mb-2"],[3,"tableFiltered","placeholder"],[1,"table-responsive"],[1,"table","table-sm","table-hover","table-bordered"],["width","30%"],[3,"columnSorted","columnTitle","thisField","currentField","currentDirection"],["width","35%"],["width","15%"],["width","20%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"totalItems"],["data-bs-dismiss","modal","data-bs-toggle","modal",3,"hidden"],[3,"click"],["colspan","5"],[3,"isLoading","isNoData"]],template:function(r,t){if(r&1){let l=F();o(0,"button",2,0),s(2,` Launch demo modal
`),n(),o(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"span",7),s(8,"Select Hotel Bill"),n(),d(9,"button",8),n(),o(10,"div",9)(11,"div",10)(12,"app-table-filtering",11),u("tableFiltered",function(){return f(l),h(t.tableFiltered)}),n()(),o(13,"div",12)(14,"table",13)(15,"thead")(16,"tr")(17,"th",14)(18,"app-table-sorting",15),u("columnSorted",function(w){return f(l),h(t.columnSorted(w))}),n()(),o(19,"th",16)(20,"app-table-sorting",15),u("columnSorted",function(w){return f(l),h(t.columnSorted(w))}),n()(),o(21,"th",17)(22,"app-table-sorting",15),u("columnSorted",function(w){return f(l),h(t.columnSorted(w))}),n()(),o(23,"th",18)(24,"app-table-sorting",15),u("columnSorted",function(w){return f(l),h(t.columnSorted(w))}),n()()()(),o(25,"tbody"),j(26,at,10,6,"tr",19)(27,lt,3,2,"tr",20),n()(),d(28,"app-table-pagination",21),n()(),o(29,"button",22,1),s(31," Launch demo modal "),n()()()()}r&2&&(c("hidden",!0),m(9),re("data-bs-target",t.closeTarget),m(3),c("placeholder","Search Bills"),m(6),c("columnTitle","Bill ID")("thisField","bill_id")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Guest Name")("thisField","guest_name")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Bill Date")("thisField","email")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("columnTitle","Bill Amount")("thisField","total_amount")("currentField",t.sorting.currentField)("currentDirection",t.sorting.currentDirection),m(2),c("ngForOf",t.billsListData),m(),c("ngIf",!t.isFetchingListData||!t.isDataAvailable),m(),c("totalItems",t.billsListData.length),m(),c("hidden",!0),re("data-bs-target",t.closeTarget))},dependencies:[Y,K,W,X,ne,ee,te,ie,Z]});let a=i;return a})();var st=["selectBillComponentReference"];function ct(a,i){if(a&1&&(o(0,"option"),s(1),n()),a&2){let p=i.$implicit;m(),S(p)}}function pt(a,i){if(a&1&&(o(0,"option"),s(1),n()),a&2){let p=i.$implicit;m(),S(p)}}function dt(a,i){if(a&1&&(o(0,"option"),s(1),n()),a&2){let p=i.$implicit;m(),S(p)}}var I=(()=>{let i=class i{constructor(e){this.formBuilder=e,this.isSubmitted=!1,this.paymentForm=new De({}),this.paymentTypes=Object.values(ce),this.currencyTypes=Object.values(pe),this.paymentMethods=Object.values(se),this.isDisabled=!1,this.selectedBillId=""}ngOnInit(){this.initializeFormData()}initializeFormData(){this.paymentForm=this.formBuilder.group({id:[{value:"",disabled:!0}],created_at:[{value:"",disabled:!0}],updated_at:[{value:"",disabled:!0}],deleted_at:[{value:"",disabled:!0}],hotel:[{value:"",disabled:!0}],bill:[{value:"",disabled:!0}],payment_id:[{value:"",disabled:!0}],payment_type:[ce.Full],guest:[{value:"",disabled:!0}],note:[""],currency:[pe.GHC],payment_method:[se.Cash],payment_date:[null,{validators:me.required}],amount:[0,{validators:me.required}]})}billRowSelected(e){this.selectedBillId=e?.id,this.paymentForm.controls.bill.setValue(e?.bill_id),this.paymentForm.controls.guest.setValue(e?.check_in_check_out?.guest?.guest_name)}};i.\u0275fac=function(r){return new(r||i)(v(Ae))},i.\u0275cmp=C({type:i,selectors:[["app-payment-form"]],viewQuery:function(r,t){if(r&1&&g(st,5,R),r&2){let l;_(l=b())&&(t.selectBill=l.first)}},decls:66,vars:5,consts:[["selectBillComponentReference",""],[1,"module-form-control",3,"formGroup"],[1,"row","mb-1"],[1,"col-md-4"],["for","bill",1,"float-md-end","float-sm-start","col-form-label"],[1,"col-md-8"],[1,"input-group","w-100"],["type","text","name","bill","id","bill","formControlName","bill",1,"form-control"],["type","button","title","Select Bill",1,"btn","btn-secondary",3,"click"],[1,"bi","bi-window"],["for","payment_id",1,"float-md-end","float-sm-start","col-form-label"],["type","text","name","payment_id","id","payment_id","formControlName","payment_id",1,"form-control"],["for","guest",1,"float-md-end","float-sm-start","col-form-label"],["type","text","name","guest","id","guest","formControlName","guest",1,"form-control"],["for","payment_type",1,"float-md-end","float-sm-start","col-form-label"],["name","payment_type","id","payment_type","formControlName","payment_type",1,"form-control","form-select"],["for","note",1,"float-md-end","float-sm-start","col-form-label"],["type","text","name","note","id","note","formControlName","note",1,"form-control"],["for","currency",1,"float-md-end","float-sm-start","col-form-label"],["name","currency","id","currency","formControlName","currency",1,"form-control","form-select"],["for","payment_method",1,"float-md-end","float-sm-start","col-form-label"],["name","payment_method","id","payment_method","formControlName","payment_method",1,"form-control","form-select"],["for","payment_date",1,"float-md-end","float-sm-start","col-form-label"],["type","date","name","payment_date","id","payment_date","formControlName","payment_date",1,"form-control"],["for","amount",1,"float-md-end","float-sm-start","col-form-label"],["type","number","name","amount","id","amount","formControlName","amount",1,"form-control"],[3,"rowSelected"]],template:function(r,t){if(r&1){let l=F();o(0,"form",1)(1,"div",2)(2,"div",3)(3,"label",4),s(4,"Bill"),n()(),o(5,"div",5)(6,"div",6),d(7,"input",7),o(8,"button",8),u("click",function(){return f(l),h(t.selectBill.openModal())}),d(9,"i",9),n()()()(),o(10,"div",2)(11,"div",3)(12,"label",10),s(13,"Payment ID"),n()(),o(14,"div",5),d(15,"input",11),n()(),o(16,"div",2)(17,"div",3)(18,"label",12),s(19,"Guest"),n()(),o(20,"div",5),d(21,"input",13),n()(),o(22,"div",2)(23,"div",3)(24,"label",14),s(25,"Payment Type"),n()(),o(26,"div",5)(27,"select",15),q(28,ct,2,1,"option",null,$),n()()(),o(30,"div",2)(31,"div",3)(32,"label",16),s(33,"Note"),n()(),o(34,"div",5),d(35,"input",17),n()(),o(36,"div",2)(37,"div",3)(38,"label",18),s(39,"Currency"),n()(),o(40,"div",5)(41,"select",19),q(42,pt,2,1,"option",null,$),n()()(),o(44,"div",2)(45,"div",3)(46,"label",20),s(47,"Payment Method"),n()(),o(48,"div",5)(49,"select",21),q(50,dt,2,1,"option",null,$),n()()(),o(52,"div",2)(53,"div",3)(54,"label",22),s(55,"Payment Date"),n()(),o(56,"div",5),d(57,"input",23),n()(),o(58,"div",2)(59,"div",3)(60,"label",24),s(61,"Payment Amount"),n()(),o(62,"div",5),d(63,"input",25),n()()(),o(64,"app-select-bill",26,0),u("rowSelected",function(w){return f(l),h(t.billRowSelected(w))}),n()}r&2&&(c("formGroup",t.paymentForm),m(28),H(t.paymentTypes),m(14),H(t.currencyTypes),m(8),H(t.paymentMethods),m(7),ae("is-invalid",t.paymentForm.controls.payment_date.invalid&&t.isSubmitted),m(6),ae("is-invalid",t.paymentForm.controls.amount.invalid&&t.isSubmitted))},dependencies:[Ee,Le,Me,we,Ie,Ve,Pe,Te,Be,ke,R]});let a=i;return a})();var ft=["successToastComponentReference"],ht=["errorToastComponentReference"],gt=["deleteModalOneComponentReference"],_t=()=>({name:"All Payments",link:"#/home/finance/payments"}),bt=()=>({name:"Create Payment",link:"#/home/finance/payments/create-payment"}),vt=(a,i)=>[a,i],Ge=(()=>{let i=class i{constructor(e,r){this.paymentsService=e,this.router=r,this.isLoading=!1}onSave(){this.paymentForm.isSubmitted=!0,this.paymentForm.paymentForm.valid&&this.handleCreatePayment()}handleCreatePayment(){let e=this.getPaymentFormData(),r=N(Q({},e),{bill:this.paymentForm.selectedBillId});this.createPayment(r)}handleCancelForm(){this.router.navigate(["/home/finance/payments"])}getPaymentFormData(){return this.paymentForm.paymentForm.value}createPayment(e){this.isLoading=!0;let r=localStorage.getItem("hotel_id"),t=N(Q({},e),{hotel:r});console.log(t),this.paymentsService.createHotelPayment(t).subscribe({next:()=>{"Payment has been created successfully";this.isLoading=!1,this.successToast.openToast()},error:l=>{`${l}`,this.isLoading=!1,this.errorToast.openToast()},complete:()=>{console.log("Complete payment posting action"),this.router.navigate(["/home/finance/payments"]),this.isLoading=!1}})}};i.\u0275fac=function(r){return new(r||i)(v(A),v(V))},i.\u0275cmp=C({type:i,selectors:[["app-create-payment"]],viewQuery:function(r,t){if(r&1&&(g(I,5),g(ft,5,P),g(ht,5,T),g(gt,5,M)),r&2){let l;_(l=b())&&(t.paymentForm=l.first),_(l=b())&&(t.successToast=l.first),_(l=b())&&(t.errorToast=l.first),_(l=b())&&(t.deleteModal=l.first)}},decls:21,vars:11,consts:[["paymentForm",""],["errorToastComponentReference",""],["successToastComponentReference",""],[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-body"],[1,"card-title"],["type","submit",1,"btn","btn-sm","btn-success","float-end","ms-2","form-control-btn",3,"click","disabled"],["type","reset",1,"btn","btn-sm","btn-warning","float-end","ms-2","form-control-btn",3,"click","disabled"],[1,"col-md-3"],[3,"link","name"]],template:function(r,t){if(r&1){let l=F();d(0,"app-topnav",3),o(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h5",8),s(6,"New Payment"),n(),d(7,"app-payment-form",null,0),o(9,"button",9),u("click",function(){return f(l),h(t.onSave())}),s(10," Save "),n(),o(11,"button",10),u("click",function(){return f(l),h(t.handleCancelForm())}),s(12," Cancel "),n()()()(),o(13,"div",11)(14,"div",6)(15,"div",7),d(16,"app-page-link-button",12),n()()()(),d(17,"app-error-toast",null,1)(19,"app-success-toast",null,2)}r&2&&(c("pageTitle","Payments")("navItems",U(8,vt,B(6,_t),B(7,bt))),m(9),c("disabled",t.isLoading),m(2),c("disabled",t.isLoading),m(5),c("link","/home/finance/bills")("name","Go to Bills"))},dependencies:[L,D,P,T,I]});let a=i;return a})();var St=["paymentForm"],Ct=["successToastComponentReference"],Ft=["errorToastComponentReference"],wt=["deleteModalOneComponentReference"],Pt=()=>({name:"All Payments",link:"#/home/finance/payments"}),Tt=a=>({name:"View Payment",link:a}),Dt=(a,i)=>[a,i],Ue=(()=>{let i=class i{constructor(e,r,t){this.route=e,this.router=r,this.paymentService=t,this.paymentId="",this.expectedPaymentBillId="",this.isLoading=!1}onSave(){this.paymentForm.isSubmitted=!0,this.paymentForm.paymentForm.valid&&this.handleUpdatePayment()}onDelete(){this.deleteModal.openModal()}ngOnInit(){this.paymentId=this.route.snapshot.params.paymentId}ngAfterViewInit(){this.getPayment()}getPayment(){this.paymentService.getHotelPaymentById(this.paymentId).subscribe({next:e=>{console.log("Successfully retrieved restaurant payment: ",e),this.setPaymentFormData(e),this.expectedPayment=e,this.expectedPaymentBillId=e.bill?.id,this.isLoading=!1},error:e=>{console.error(`Error retrieving restaurant payment: ${e.message}`),this.isLoading=!1},complete:()=>{this.isLoading=!1,console.log("Fetching complete")}})}setPaymentFormData(e){this.paymentForm.paymentForm.patchValue(e),this.paymentForm.paymentForm.controls.guest.setValue(e.bill?.check_in_check_out?.guest?.guest_name),this.paymentForm.paymentForm.controls.bill.setValue(e.bill?.bill_id)}handleUpdatePayment(){this.isLoading=!0;let e=N(Q({},this.paymentForm.paymentForm.value),{hotel:localStorage.getItem("hotel_id"),bill:this.expectedPaymentBillId});this.paymentService.updateHotelPaymentById(this.paymentId,e).subscribe({next:r=>{"Payment update successful";this.router.navigateByUrl("/home/finance/payments"),this.isLoading=!1,this.successToast.openToast()},error:r=>{console.log(r.message),this.isLoading=!1,this.errorToast.openToast()}})}handleDeletePayment(){this.isLoading=!0,this.paymentService.deleteHotelPaymentById(this.paymentId).subscribe({next:e=>{console.log(e),this.router.navigateByUrl("/home/finance/payments"),this.isLoading=!1,this.successToast.openToast()},error:e=>{console.log(e),this.isLoading=!1,this.errorToast.openToast()}})}handleCancelEvent(){this.router.navigate(["/home/food/payments"])}};i.\u0275fac=function(r){return new(r||i)(v(Se),v(V),v(A))},i.\u0275cmp=C({type:i,selectors:[["app-edit-view-payment"]],viewQuery:function(r,t){if(r&1&&(g(St,5,I),g(Ct,5,P),g(Ft,5,T),g(wt,5,M)),r&2){let l;_(l=b())&&(t.paymentForm=l.first),_(l=b())&&(t.successToast=l.first),_(l=b())&&(t.errorToast=l.first),_(l=b())&&(t.deleteModal=l.first)}},decls:25,vars:13,consts:[["paymentForm",""],["errorToastComponentReference",""],["successToastComponentReference",""],["deleteModalOneComponentReference",""],[3,"pageTitle","navItems"],[1,"row"],[1,"col-md-6","row"],[1,"card"],[1,"card-body"],[1,"card-title"],["type","submit",1,"btn","btn-sm","btn-success","float-end","ms-2","form-control-btn",3,"click","disabled"],["type","reset",1,"btn","btn-sm","btn-warning","float-end","ms-2","form-control-btn",3,"click","disabled"],["type","reset",1,"btn","btn-sm","btn-danger","float-end","ms-2","form-control-btn",3,"click","disabled"],[1,"col-md-3"],[3,"link","name"],[3,"confirmEvent"]],template:function(r,t){if(r&1){let l=F();d(0,"app-topnav",4),o(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"h5",9),s(6,"View Payment"),n(),d(7,"app-payment-form",null,0),o(9,"button",10),u("click",function(){return f(l),h(t.handleUpdatePayment())}),s(10," Save "),n(),o(11,"button",11),u("click",function(){return f(l),h(t.handleCancelEvent())}),s(12," Cancel "),n(),o(13,"button",12),u("click",function(){return f(l),h(t.onDelete())}),s(14," Delete "),n()()()(),o(15,"div",13)(16,"div",7)(17,"div",8),d(18,"app-page-link-button",14),n()()()(),d(19,"app-error-toast",null,1)(21,"app-success-toast",null,2),o(23,"app-delete-modal-one",15,3),u("confirmEvent",function(){return f(l),h(t.handleDeletePayment())}),n()}r&2&&(c("pageTitle","Payments")("navItems",U(10,Dt,B(7,Pt),G(8,Tt,"#/home/finance/payments/"+t.paymentId))),m(9),c("disabled",t.isLoading),m(2),c("disabled",t.isLoading),m(2),c("disabled",t.isLoading),m(5),c("link","/home/finance/payments")("name","Go to Payments"))},dependencies:[L,D,M,P,T,I]});let a=i;return a})();var Et=[{path:"",component:je,children:[{path:"",component:ye},{path:"all-payments",component:ye},{path:"edit-view-payment/:paymentId",component:Ue},{path:"create-payment",component:Ge}]}],ze=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=O({type:i}),i.\u0275inj=x({imports:[le.forChild(Et),le]});let a=i;return a})();var Ei=(()=>{let i=class i{};i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=O({type:i}),i.\u0275inj=x({imports:[Y,Re,Qe,ze,Ne,D,ne,R,xe]});let a=i;return a})();export{Ei as PaymentsModule};
